{"version":3,"sources":["logo.svg","utils/noImageFound.png","component/layout/Layout_01.js","utils/component/confirmation.js","utils/Constants.js","component/header/Header_01.js","utils/component/Loading.js","component/page/Login.js","utils/component/notification.js","component/page/component/Page_01.js","component/page/component/InventoryFormTable.js","utils/ApolloClientAPI.js","utils/qiniuAPI.js","component/page/component/ProductForm.js","component/page/Products.js","component/page/Inventory.js","component/page/component/OrderInfo.js","component/page/Orders.js","utils/component/PrivateRoute.js","utils/component/PublicRoute.js","utils/component/PageNotFound.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","Layout_01","props","id","className","header","children","footer","confirmation","type","content","callback","config","title","toUpperCase","icon","ExclamationCircleOutlined","okType","onCancel","destroyAll","defaultImage_system","require","handleConfigOuput","result","newDefaultImage","defaultImage","imageSrc","GET_USER_CACHE_QUERY","gql","SET_USER_CACHE_QUERY","useUserCache","useQuery","fetchPolicy","data","error","loading","console","log","user","setUserCache","client","theClient","DefaultClientAPI","writeQuery","query","GET_CONFIG_CACHE_QUERY","useConfigCache","setConfigCache","LOGOUT_MUTATION","Header_01","apolloClient","useApolloClient","routeHistory","useHistory","useMutation","onCompleted","logout","success","resetStore","then","useState","menuCollapsed","setMenuCollapsed","menuItem","name","route","data-header-collapsed","shape","ArrowLeftOutlined","rotate","map","aMenuItem","index","buttonProps","push","location","pathname","key","onClick","placement","getMenuItemDisplay","style","cursor","profile","LogoutOutlined","Loading","showLoading","LoadingOutlined","LOGIN_MUTATION","GET_USER_CONFIG_QUERY","layout","labelCol","span","wrapperCol","tailLayout","offset","Login","login","fetchConfig","variables","configId","message","description","notification","useLazyQuery","result2","userConfig","initialValues","remember","onFinish","values","onFinishFailed","errorInfo","Item","label","rules","required","Password","valuePropName","htmlType","Page_01","rest","Fragment","Search","EditableContext","React","createContext","EditableRow","useForm","form","component","Provider","value","EditableCell","editable","dataIndex","record","handleSave","isVariant","restProps","editing","setEditing","inputRef","useRef","useContext","useEffect","current","focus","toggleEdit","setFieldsValue","save","e","a","validateFields","childNode","margin","width","height","ref","onPressEnter","onBlur","paddingRight","min","step","formatter","replace","parser","InventoryFormTable","productId","inventoryData","setInventoryData","productVariants","setProductVariants","newColModal","setNewColModal","handleRemoveColumn","selectedCol","restVariant","newInventory","anInventory","handleUpdatePublished","selectedRow","checked","preventDefault","updateIndex","aData","indexOf","update","published","$set","handleDeleteRow","filter","item","row","newData","findIndex","splice","components","body","cell","columnsObj","variantColKeys","Object","keys","defaultColumns","fixed","sorter","b","price","stock","align","render","text","textAlign","checkedChildren","unCheckedChildren","onChange","block","PlusOutlined","disabled","length","onConfirm","DeleteOutlined","aColKey","ellipsis","filterIcon","EditOutlined","filterDropdown","padding","display","visible","enterButton","CheckOutlined","defaultValue","onSearch","confirm","editVariant","marginLeft","onFilter","concat","getColumns","col","onCell","Date","getTime","_id","marginRight","marginBottom","rowClassName","bordered","dataSource","columns","size","pagination","scroll","x","bodyStyle","paddingBottom","onOk","newVariantValue","getFieldValue","variantName","newVariantId","resetFields","maxLength","ApolloClientAPI","middletierURL","cache","InMemoryCache","addTypename","ApolloClient","link","HttpLink","uri","credentials","params","Promise","resolve","reject","catch","err","mutation","mutate","QINIU_UPLOAD_TOKEN_QUERY","QINIU_BATCH_DELETE_QUERY","qiniuAPI","loadToken","qiniuToken","upload","file","fileObj","originFileObj","useCdnDomain","region","qiniu","z0","putExtra","fname","mimeType","response","uploadToken","subscribe","next","res","complete","batchDelete","images","imageMogr2","options","domain","Panel","Option","READ_PRODUCT_INVENTORY_QUERY","BULK_UPDATE_INVENTORY_QUERY","CREATE_NEW_PRODUCT_QUERY","DELETE_PRODUCT_QUERY","UPDATE_PRODUCT_QUERY","getImageFilesToModify","defaultArray","newArray","newImageToUpload","currentUploadedImages","imagesToDelete","allImages","anImage","newImageName","imageNameSplited","split","fav","anUploadedImage","delete","uploaded","getBase64","reader","FileReader","readAsDataURL","onload","onerror","ProductInfoForm","product","categories","refetch","modalProps","fileList","setFileList","previewVisible","setPreviewVisible","previewImage","setPreviewImage","productCategory","setProductCategory","newCategoryName","setNewCategoryName","modalVisible","productObj","assign","category","newCategoryFormat","aCategory","variants","readInventory","array","getDefaultImageArray","setModalFooter","getModalFooter","uploadButton","handleFavImageChange","newFileList","aFile","handlePreviewOpen","url","preview","inventory","flattenedInventory","restInventory","readInventoryResult","bulkUpdateInventory","createProduct","deleteProduct","updateProduct","finalProductValue","foundSelectedCategory","find","imagesToBeModified","QiniuAPI","aNewImage","variantObj","aKey","hasOwnProperty","deletedInventory","aNewInventory","deleted","onDeleteProduct","onCategoryNameChange","target","addNewCategory","modalFooter","submit","unshift","defaultActiveKey","expandIconPosition","TextArea","rows","placeholder","labelInValue","allowClear","dropdownRender","menu","flexWrap","flex","accept","beforeUpload","listType","multiple","onPreview","slice","fileLimit","isFav","StarFilled","color","StarOutlined","getPreviewModalFooter","alt","src","thumbUrl","ProductForm","closeModal","destroyOnClose","wrapClassName","overflow","GET_PRODUCTS_QUERY","UPDATE_PRODUCT_PUBLISH","UPDATE_INVENTORY_PUBLISH","getAllProductCategory","products","aProduct","anItem","Inventory","productFormModal","setProductFormModal","selectedProduct","setSelectedProduct","selectedItems","setSelectedItems","displaySelectionPanel","setDisplaySelectionPanel","onError","productsData","refetchProducts","inventoryError","refetchInventory","updateProductPublish","updateInventoryPublish","handleOnClickProduct","createdAt","format","newName","variantKeys","sum","aChild","rowSelection","selectedRowKeys","selectedRows","onSelect","selected","onSelectAll","changeRows","extra","inventoryWithKey","productInventory","getTableData","inventoryIds","productIds","ids","selectionPanel","OrderInfo","order","orientation","column","xxl","xl","lg","md","sm","xs","paid","sentOut","trackingNum","customer","itemLayout","items","renderItem","variant","image","actions","qty","Meta","avatar","total","TabPane","GET_ORDERS_QUERY","UPDATE_ORDER_PAYMENT_QUERY","UPDATE_ORDER_DELIVERY_QUERY","CANCEL_ORDER_QUERY","Orders","orderModalDisplay","setOrderModalDisplay","selectedOrder","setSelectedOrder","refetchOrders","updateOrderPayment","updateOrderDelivery","cancelOrder","whiteSpace","textDecoration","handleOrderModalDisplayOpen","filteredColumns","newOrders","paidOrders","completedOrders","updatedAt","filteredOrders","allOrders","orders","orderList1","orderList2","orderList3","anOrder","getFilteredOrders","tab","rowKey","PrivateRoute","Component","routeLocation","useLocation","userResult","configResult","loggedIn","to","state","from","PublicRoute","restricted","PageNotFound","Component_Layout","Component_Header","App","setLoggedIn","configCache","Main","exact","path","Boolean","window","hostname","match","GET_LOGGED_IN_USER","GET_USER_CONFIG","theClientAPI","restClient","writeData","doRender","userData","configData","ReactDOM","document","getElementById","loggedInUser","error2","run","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.31b046b9.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.25bf045c.svg\";","module.exports = __webpack_public_path__ + \"static/media/noImageFound.3a5a71c0.png\";","import React from 'react';\n\nconst Layout_01 = (props) => {\n\n  return (\n    <div id=\"layout_01\">\n      <div className=\"wrapper layout_01-wrapper\">\n        <div className=\"header\">\n          {props.header ? props.header : null}\n        </div>\n        <div className=\"content\">\n          {props.children ? props.children : null}\n          <div className=\"footer\">\n            {props.footer ? props.footer : null}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Layout_01;","\nimport React from 'react';\nimport { Modal, Button } from 'antd';\nimport {\n  ExclamationCircleOutlined\n} from '@ant-design/icons';\n\nconst confirmation = (type, content, callback = null) => {\n  // type: confirm/warning/info/error\n  const config = {\n    title: type && typeof(type) == 'string' ? type.toUpperCase() : \"...\",\n    icon: <ExclamationCircleOutlined />,\n    content: content,\n    okType: 'danger',\n    onCancel: ()=>{\n      Modal.destroyAll();\n    }\n  };\n  if (callback != null) {\n    config['onOk'] = callback;\n  }\n  Modal[type](config);\n}\n\nexport default confirmation;","import { useQuery, useLazyQuery } from \"@apollo/react-hooks\";\nimport gql from \"graphql-tag\";\n\nimport DefaultClientAPI from '../index';\n\n// export const MIDDLETIER_URL = \"http://localhost:3000/graphql\";\nexport const MIDDLETIER_URL = \"http://13.124.162.243/graphql\";\n\nexport const defaultImage_system = require(\"./noImageFound.png\");\n\nconst handleConfigOuput = (config = null) => {\n  let result = null;\n  if (config) {\n    result = {...config}\n    let newDefaultImage = defaultImage_system;\n    if (result.defaultImage && result.defaultImage != \"\") {\n      newDefaultImage = result.imageSrc + result.defaultImage;\n    }\n    result['defaultImage'] = newDefaultImage;\n  }\n  return result;\n}\n\n\n// User Cache ---------------------------- start\nconst GET_USER_CACHE_QUERY = gql`\n  query user {\n    user @client {\n      success\n      message\n      data {\n        _id\n        username\n        configId\n      } \n    }\n  }\n`\nconst SET_USER_CACHE_QUERY = gql`\n  query user {\n    user {\n      success\n      message\n      data {\n        _id\n        username\n        configId\n      } \n    }\n  }\n`\n\nexport const useUserCache = () => {\n  const  { data, error, loading } = useQuery(GET_USER_CACHE_QUERY,{\n    fetchPolicy: 'cache-only'\n  });\n\n  let result = null;\n  if (loading) {\n    // console.log('loading');\n  }\n  if (error) {\n    console.log('useUserCache',error);\n  }\n  if (data && data.user) {\n    result = data.user;\n  }\n  return result;\n}\n\nexport const setUserCache = (data, client=null) => {\n  let theClient = DefaultClientAPI.client;\n  if (client != null) {\n    theClient = client;\n  }\n  theClient.writeQuery({\n    query: SET_USER_CACHE_QUERY,\n    data: {\n      user: data\n    }\n  });\n  // theClient.writeData({\n  //   data: {\n  //     user: data\n  //   }\n  // });\n}\n\n// export const getUserCache = (client=null) => {\n//   let result = null;\n//   let theClient = DefaultClientAPI.client;\n//   if (client != null) {\n//     theClient = client;\n//   }\n//   try {\n//     result = theClient.readQuery({\n//       query: GET_USER_CACHE_QUERY\n//     },true)\n//   }\n//   catch (e) {\n//     result = null;\n//   }\n\n//   return result;\n// }\n\n\n// User Cache ---------------------------- end\n// Config Cache ---------------------------- start\nconst GET_USER_CONFIG_QUERY = gql`\n  query userConfig($configId: String!) {\n    userConfig(configId: $configId) {\n        success\n        message\n        data\n    }\n  }\n`\nconst GET_CONFIG_CACHE_QUERY = gql`\n  query config {\n    config @client {\n      _id\n      configId\n      defaultImage\n      defaultImage_system\n      imageSrc\n      paymentQRImage\n      server\n      profile {\n        name\n      }\n    }\n  }\n`\nconst SET_CONFIG_CACHE_QUERY = gql`\n  query config {\n    config {\n      _id\n      configId\n      defaultImage\n      defaultImage_system\n      imageSrc\n      paymentQRImage\n      server\n      profile {\n        name\n      }\n    }\n  }\n`\nexport const useConfigCache = () => {\n  const { data, error, loading } = useQuery(GET_CONFIG_CACHE_QUERY,{\n    fetchPolicy: 'cache-only'\n  });\n\n  let result = null;\n  if (loading) {\n    // console.log('loading');\n  }\n  if (error) {\n    console.log('useConfigCache',error);\n  }\n  if (data && data.config) {\n    result = data.config;\n  }\n  return result;\n}\n\nexport const setConfigCache = (data, client=null) => {\n  let theClient = DefaultClientAPI.client;\n  if (client != null) {\n    theClient = client;\n  }\n  theClient.writeQuery({\n    query: GET_CONFIG_CACHE_QUERY,\n    data: {\n      config: handleConfigOuput(data)\n    }\n  });\n  // theClient.writeData({\n  //   data: {\n  //     config: handleConfigOuput(data)\n  //   }\n  // });\n}\n\n// export const getConfigCache = (client=null) => {\n//   let result = null;\n//   let theClient = DefaultClientAPI.client;\n//   if (client != null) {\n//     theClient = client;\n//   }\n//   try {\n//     result = theClient.readQuery({\n//       query: SET_CONFIG_CACHE_QUERY\n//     },true) \n//   }\n//   catch (e) {\n//     result = null;\n//   }\n\n//   return result;\n// }\n\nexport const useConfigQuery = (input) => {\n  // const [ getConfig, { data, error, loading } ] = useLazyQuery(GET_USER_CONFIG_QUERY,{\n  const { data, error, loading } = useQuery(GET_USER_CONFIG_QUERY,{\n    fetchPolicy: 'cache-and-network',\n    variables: {\n      configId: input\n    },\n    onCompleted: (result) => {\n      if (result && result.userConfig && result.userConfig.success) {\n        setConfigCache(result.userConfig.data)\n      }\n    }\n  });\n  let result = null;\n  if (loading) {\n    // console.log('loading');\n  }\n  if (error) {\n    console.log('useConfigQuery',error);\n  }\n  if (data && data.userConfig) {\n    result = handleConfigOuput(data.userConfig);\n  }\n  return result;\n}\n// Config Cache ---------------------------- end\n\n\n// const GET_LOGGED_IN_USER = gql`\n//   query loggedInUser{\n//     loggedInUser{\n//         success\n//         message\n//         data\n//     }\n//   }\n// `\n// export const useUserQuery = () => {\n//   const [getUser, { data, error, loading }] = useLazyQuery(GET_LOGGED_IN_USER,{\n//     //fetchPolicy: 'cache-and-network'\n//   });\n\n//   let result = null;\n//   if (loading) {\n//     console.log('loading');\n//   }\n//   if (error) {\n//     console.log(error);\n//   }\n//   if (data && data.user) {\n//     result = data.user;\n//   }\n//   return result;\n// }","import React, { useState, useEffect } from 'react';\nimport { useQuery, useMutation, useApolloClient } from \"@apollo/react-hooks\";\nimport gql from \"graphql-tag\";\nimport {\n  useHistory\n} from \"react-router-dom\";\nimport { NavHashLink as NavLink } from 'react-router-hash-link';\nimport { Menu, Divider, Button, Tooltip } from 'antd';\nimport {\n  ArrowLeftOutlined,\n  LogoutOutlined\n} from '@ant-design/icons';\nimport confirmation from '../../utils/component/confirmation';\nimport { useConfigCache, setConfigCache, setUserCache } from '../../utils/Constants';\n\nconst LOGOUT_MUTATION = gql`\n    mutation logout {\n      logout {\n        success\n        message\n        data\n      }\n    }\n`;\n\nconst Header_01 = (props) => {\n  const apolloClient = useApolloClient();\n  let routeHistory = useHistory();\n  const config = useConfigCache();\n  const [logout] = useMutation(LOGOUT_MUTATION, {\n    onCompleted: (result) => {\n      if (result && result.logout && result.logout.success) {\n        let redirectPath = '/login';\n        // if (routeHistory.location.state && routeHistory.location.state.from) {\n        //   redirectPath = routeHistory.location.state.from.pathname\n        // }\n        \n        apolloClient.resetStore().then(()=>{\n          setConfigCache(null)\n          setUserCache(null)\n          // routeHistory.push(redirectPath)\n\n        })\n        // apolloClient.clearStore()\n      }\n    }\n  });\n\n  const [menuCollapsed, setMenuCollapsed] = useState(false);\n  const handleMenuOpen = () => {\n    setMenuCollapsed(true)\n  }\n  const handleMenuClose = () => {\n    setMenuCollapsed(false)\n  }\n\n  const handleLogout = () => {\n    confirmation('confirm', 'Confirm Logout?', ()=>{\n      logout();\n    })\n  }\n\n  const menuItem = [\n    // {\n    //   name: 'Products',\n    //   icon: null,\n    //   route: '/products'\n    // },\n    {\n      name: 'Inventory',\n      icon: null,\n      route: '/'\n    },\n    {\n      name: 'Orders',\n      icon: null,\n      route: '/orders'\n    },\n    // {\n    //   name: 'Configuration',\n    //   icon: null,\n    //   route: '/configuration'\n    // }\n  ]\n\n  const getMenuItemDisplay = () => {\n    let result = [];\n    menuItem.map((aMenuItem,index)=>{\n      let buttonProps = {\n        shape: 'circle'\n      }\n      if (menuCollapsed) {\n        buttonProps['shape'] = 'circle';\n      }\n      else {\n        buttonProps['type'] = 'link'\n      }\n      result.push(\n        <div className={`header_01-item ${routeHistory.location.pathname == aMenuItem.route ? \"header_01-activeLink\" : \"\"}`} key={index} onClick={()=>{\n          routeHistory.push(aMenuItem.route)\n          }}>\n          {\n            menuCollapsed ? \n            <Tooltip title={aMenuItem.name} placement=\"right\">\n              <Button {...buttonProps}>{aMenuItem.name[0].toUpperCase()}</Button>\n            </Tooltip>\n            : <span className={routeHistory.location.pathname == aMenuItem.route ? \"header_01-activeLink\" : \"\"}>{aMenuItem.name}</span>\n          }\n        </div>\n      )\n    });\n    return result;\n  }\n\n  return (\n    <header id=\"header_01\" data-header-collapsed={menuCollapsed}>\n      <div className=\"header_01-header\">\n        <div className=\"header_01-item collapse-btn\">\n           <Button \n              shape=\"circle\" \n              type=\"link\"\n              shape=\"circle\"\n              icon={<ArrowLeftOutlined rotate={menuCollapsed ? 180 : 0} />} \n              onClick={menuCollapsed ? handleMenuClose : handleMenuOpen}\n            />\n          {/* <ArrowLeftOutlined rotate={menuCollapsed ? 180 : 0} onClick={menuCollapsed ? handleMenuClose : handleMenuOpen} /> */}\n        </div>\n      </div>\n\n      <div className=\"header_01-content\">\n        {getMenuItemDisplay()}\n      </div>\n      <div className=\"header_01-footer\">\n        {\n          config && !menuCollapsed ? (\n            <div className=\"header_01-item\" style={{cursor: 'default'}}>\n              { config.profile.name }\n            </div>\n          ) : null\n        }\n        <div className=\"header_01-item\" onClick={handleLogout}>\n          {\n            menuCollapsed ?\n                <Tooltip title=\"Logout\" placement=\"right\">\n                  <Button \n                    shape=\"circle\" \n                    icon={<LogoutOutlined />} \n                  />\n                </Tooltip>\n              : \n              <span>Logout</span>\n          }\n        </div>\n      </div>\n    </header>\n  );\n}\n\nexport default Header_01;","import React, {useState} from 'react';\nimport {\n  LoadingOutlined\n} from '@ant-design/icons';\n\nconst Loading = (props) => {\n  const [showLoading, setShowLoading] = useState(true);\n\n  if (showLoading) {\n    return (\n      <div className=\"loading\">\n        <LoadingOutlined/>\n      </div>\n    )\n  }\n  return null;\n}\n\nexport default Loading;","import React from 'react';\nimport { useLazyQuery, useMutation, useApolloClient } from \"@apollo/react-hooks\";\nimport gql from \"graphql-tag\";\nimport { Form, Input, Button, Checkbox } from 'antd';\nimport { useHistory } from \"react-router-dom\";\n\nimport Loading from '../../utils/component/Loading';\nimport { setUserCache, setConfigCache } from '../../utils/Constants';\nimport * as notification from '../../utils/component/notification';\n\nconst LOGIN_MUTATION = gql`\n    mutation login($user: JSONObject) {\n      login(user: $user) {\n        success\n        message\n        data\n      }\n    }\n`;\n\nconst GET_USER_CONFIG_QUERY = gql`\n  query userConfig($configId: String!) {\n    userConfig(configId: $configId) {\n        success\n        message\n        data\n    }\n  }\n`\n\nconst layout = {\n  labelCol: {\n    span: 8,\n  },\n  wrapperCol: {\n    span: 16,\n  },\n};\nconst tailLayout = {\n  wrapperCol: {\n    offset: 8,\n    span: 16,\n  },\n};\n\nconst Login = (props) => {\n  let routeHistory = useHistory();\n  const [login, { data, loading }] = useMutation(LOGIN_MUTATION,{\n    onCompleted: (result)=>{\n      if (result && result.login && result.login.success) {\n        let redirectPath = '/';\n        // if (routeHistory.location.state && routeHistory.location.state.from) {\n        //   redirectPath = routeHistory.location.state.from.pathname\n        // }\n        fetchConfig({\n          variables: {\n            configId: result.login.data.configId\n          }\n        })\n        // routeHistory.push(redirectPath)\n      }\n      else {\n        notification.showMessage({type: 'error',message: \"Failed to login\"})\n      }\n    } \n  });\n\n  const [ fetchConfig ] = useLazyQuery(GET_USER_CONFIG_QUERY,{\n    fetchPolicy: 'cache-and-network',\n    onCompleted: (result2) => {\n      if (result2 && result2.userConfig && result2.userConfig.success) {\n        setConfigCache(result2.userConfig.data)\n        setUserCache(data.login)\n      }\n    }\n  });\n\n  const onFinish = values => {\n    login({\n      variables: { user: values }\n    });\n  };\n\n  const onFinishFailed = errorInfo => {\n    console.log('Failed:', errorInfo);\n  };\n\n  return (\n    <div id=\"page_login\">\n      <Form\n        {...layout}\n        name=\"basic\"\n        initialValues={{\n          remember: true,\n        }}\n        onFinish={onFinish}\n        onFinishFailed={onFinishFailed}\n      >\n        <Form.Item\n          label=\"账号\"\n          name=\"username\"\n          rules={[\n            {\n              required: true,\n              message: 'Please input your username!',\n            },\n          ]}\n        >\n          <Input />\n        </Form.Item>\n\n        <Form.Item\n          label=\"密码\"\n          name=\"password\"\n          rules={[\n            {\n              required: true,\n              message: 'Please input your password!',\n            },\n          ]}\n        >\n          <Input.Password />\n        </Form.Item>\n\n        <Form.Item {...tailLayout} name=\"remember\" valuePropName=\"checked\">\n          <Checkbox>Remember me</Checkbox>\n        </Form.Item>\n\n        <Form.Item {...tailLayout}>\n          <Button type=\"primary\" htmlType=\"submit\">\n            登入\n          </Button>\n        </Form.Item>\n      </Form>\n      {\n        loading ? <Loading/> : null\n      }\n    </div>\n  );\n}\n\nexport default Login;","import React from 'react';\nimport { notification, Alert } from 'antd';\n\nexport const showMessage = ({ type, message, description })=>{\n  let options = {};\n  if(type ===\"error\"){\n    options = {\n      duration: 6\n    }\n  }\n  notification[type]({\n    //message: (<Alert message={message} type={type} />),\n    message: message,\n    //description: description,\n    //className: `notification-${type}`,\n    //...options\n  });\n}","import React from 'react';\nimport { PageHeader } from 'antd';\n\nconst Page_01 = (props) => {\n  const {children, ...rest} = props;\n  return (\n    <React.Fragment>\n      <div id=\"page_01\">\n        <PageHeader\n          {...rest}\n        >\n          {props.children}\n        </PageHeader>\n      </div>\n    </React.Fragment>\n  )\n  // return (\n  //   <React.Fragment>\n  //     <div id=\"page_01\">\n  //       <PageHeader\n  //         {...rest}\n  //       >\n  //       </PageHeader>\n  //       {props.children}\n  //     </div>\n  //   </React.Fragment>\n  // )\n}\n\nexport default Page_01;","import React, { useContext, useState, useEffect, useRef } from 'react';\nimport { Table, Input, Button, Popconfirm, Form, InputNumber, Modal, Tooltip, Switch } from 'antd';\nimport { DeleteOutlined, PlusOutlined, EditOutlined, CheckOutlined } from '@ant-design/icons';\nimport update from 'immutability-helper';\n\nconst { Search } = Input;\n\nconst EditableContext = React.createContext();\n\nconst EditableRow = ({ index, ...props }) => {\n  const [form] = Form.useForm();\n  return (\n    <Form form={form} component={false}>\n      <EditableContext.Provider value={form}>\n        <tr {...props} />\n      </EditableContext.Provider>\n    </Form>\n  );\n};\n\nconst EditableCell = ({\n  title,\n  editable,\n  children,\n  dataIndex,\n  record,\n  handleSave,\n  isVariant = false,\n  ...restProps\n}) => {\n  const [editing, setEditing] = useState(false);\n  const inputRef = useRef();\n  const form = useContext(EditableContext);\n  useEffect(() => {\n    if (editing) {\n      inputRef.current.focus();\n    }\n  }, [editing]);\n\n  const toggleEdit = () => {\n    setEditing(!editing);\n    form.setFieldsValue({\n      [dataIndex]: record[dataIndex],\n    });\n  };\n\n  const save = async e => {\n    try {\n      const values = await form.validateFields();\n      toggleEdit();\n      handleSave({ ...record, ...values });\n    } catch (errInfo) {\n      console.log('Save failed:', errInfo);\n    }\n  };\n\n  let childNode = children;\n  if (isVariant) {\n    childNode = editing ? (\n      <Form.Item\n        style={{\n          margin: 0,\n          width: '100%',\n          height: '100%'\n        }}\n        name={dataIndex}\n      >\n        <Input ref={inputRef} onPressEnter={save} onBlur={save} />\n      </Form.Item>\n    ) : (\n      <div\n        className=\"editable-cell-value-wrap\"\n        style={{\n          paddingRight: 24,\n        }}\n        onClick={toggleEdit}\n      >\n        {children}\n      </div>\n    );\n  }\n  else {\n    if (editable) {\n      childNode = editing ? (\n        <Form.Item\n          style={{\n            margin: 0,\n            width: '100%',\n            height: '100%'\n          }}\n          name={dataIndex}\n          rules={[\n            {\n              required: true,\n              message: `${title} is required.`,\n            },\n          ]}\n        >\n          {\n            dataIndex == 'price' ?\n              <InputNumber \n                ref={inputRef} \n                min={0} \n                step={1} \n                formatter={value => `$ ${value}`.replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',')}\n                parser={value => value.replace(/\\$\\s?|(,*)/g, '')}\n                onPressEnter={save} \n                onBlur={save}\n              /> \n              : dataIndex == 'stock' ? \n                <InputNumber \n                  ref={inputRef} \n                  min={0} \n                  step={1} \n                  onPressEnter={save} \n                  onBlur={save}\n                />\n                : <Input ref={inputRef} onPressEnter={save} onBlur={save} />\n          }\n        </Form.Item>\n      ) : (\n        <div\n          className=\"editable-cell-value-wrap\"\n          style={{\n            paddingRight: 24,\n          }}\n          onClick={toggleEdit}\n        >\n          {children}\n        </div>\n      );\n    }\n  }\n\n\n  return <td {...restProps}>{childNode}</td>;\n};\n\nconst InventoryFormTable = (props) => {\n  const { productId, inventoryData, setInventoryData, productVariants, setProductVariants } = props;\n  \n  const [ selectedRows, setSelectedRows ] = useState([]);\n\n  const [ newColModal, setNewColModal ] = useState(false);\n  const [ form ] = Form.useForm();\n\n  const maxInventory = 20;\n  const maxVariants = 4;\n\n  const getColumns = () => {\n    let result = [];\n    let variantColKeys = Object.keys(productVariants);\n\n    let defaultColumns = [\n      {\n        title: 'Price',\n        dataIndex: 'price',\n        editable: true,\n        width: 100,\n        fixed: 'right',\n        sorter: (a, b) => {\n          return a.price - b.price\n        },\n      },\n      {\n        title: 'Stock',\n        dataIndex: 'stock',\n        editable: true,\n        width: 100,\n        fixed: 'right',\n        sorter: (a, b) => {\n          return a.stock - b.stock\n        },\n      },\n      {\n        title: 'Published',\n        dataIndex: 'published',\n        width: 100,\n        fixed: 'right',\n        align: 'center',\n        render: (text, record) => {\n          return (\n              <div style={{width: '100%', textAlign: 'center', cursor: 'pointer'}}>\n                <Switch checkedChildren=\"Active\" unCheckedChildren=\"Inactive\" checked={record.published} onChange={(checked, e)=>{handleUpdatePublished(record, checked, e)}} />\n              </div>\n          )\n          // return (\n          //   record.published ? <Tag color=\"green\">ON</Tag> : <Tag color=\"red\">OFF</Tag>\n          // )\n        } \n      },\n      // {\n      //   title: \"Add Variant\",\n      //   dataIndex: 'operation',\n      //   width: 50,\n      //   align: 'center',\n      //   fixed: 'right',\n      //   filterIcon: (<PlusOutlined />),\n      //   filterDropdown: (props) => {\n      //     const editVariant = (value) => {\n      //       props.confirm();\n      //       if (value) {\n      //         let newVariantId = 'v' + new Date().getTime();\n      //         setProductVariants({...productVariants, [newVariantId]: value});\n      //       }\n      //     }\n      //     return (\n      //       <div style={{padding: '10px', display: 'flex'}}>\n      //         {\n      //           props.visible ? \n      //             <Search\n      //               enterButton={(<CheckOutlined />)}\n      //               onSearch={editVariant}\n      //               //size=\"small\"\n      //             />\n      //           : null\n      //         }\n      //       </div>\n      //     )\n      //   }, \n      //   render: (text, record) =>\n      //     inventoryData.length >= 1 ? (\n      //       <Popconfirm title=\"Sure to delete?\" onConfirm={() => handleDeleteRow(record.key)}>\n      //         <div style={{width: '100%', textAlign: 'center', cursor: 'pointer'}}><DeleteOutlined /></div>\n      //       </Popconfirm>\n      //     ) : null,\n      // },\n      {\n        title: (\n          <Tooltip title=\"New Variant\">\n            <Button\n              onClick={()=>{setNewColModal(true)}}\n              block\n              type='link'\n              icon={(<PlusOutlined/>)}\n              disabled={variantColKeys.length < maxVariants ? false : true}\n            />\n          </Tooltip>\n        ),\n        dataIndex: 'operation',\n        width: 50,\n        align: 'center',\n        fixed: 'right',\n        render: (text, record) =>\n          inventoryData.length >= 1 ? (\n            <Popconfirm title=\"Sure to delete?\" onConfirm={() => handleDeleteRow(record.key)}>\n              <div style={{width: '100%', textAlign: 'center', cursor: 'pointer'}}><DeleteOutlined /></div>\n            </Popconfirm>\n          ) : null,\n      }\n    ];\n\n    // result.push(\n    //   {\n    //     title: 'SKU',\n    //     dataIndex: 'sku',\n    //     width: 150,\n    //     editable: true,\n    //   }\n    // );\n\n    if (variantColKeys && variantColKeys.length > 0) {\n      variantColKeys.map((aColKey)=>{\n        result.push(\n          {\n            title: productVariants[aColKey],\n            dataIndex: aColKey,\n            editable: true,\n            isVariant: true,\n            width: 150,\n            ellipsis: true,\n            sorter: (a, b) => {\n              if (a[aColKey] > b[aColKey]) {\n                  return -1;\n              }\n              if (b[aColKey] > a[aColKey]) {\n                  return 1;\n              }\n              return 0;\n              // return a[aColKey] > b[aColKey]\n            },\n            filterIcon: (<EditOutlined />),\n            filterDropdown: (props) => {\n              const editVariant = (value) => {\n                props.confirm();\n                setProductVariants({...productVariants, [aColKey]: value});\n              }\n              const removeVariant = () => {\n                props.confirm();\n                handleRemoveColumn(aColKey)\n              }\n              return (\n                <div style={{padding: '10px', display: 'flex'}}>\n                  {\n                    props.visible ? \n                    <React.Fragment>\n                      <Search\n                        enterButton={(<CheckOutlined />)}\n                        defaultValue={productVariants[aColKey]}\n                        onSearch={value => editVariant(value)}\n                        //size=\"small\"\n                      />\n                      <Popconfirm title=\"Sure to delete?\" onConfirm={removeVariant}>\n                        <Button type=\"danger\" icon={<DeleteOutlined/>} style={{marginLeft: '5px'}} />\n                      </Popconfirm>\n                    </React.Fragment>\n                    : null\n                  }\n                </div>\n              )\n            }, \n            onFilter: () => {\n              console.log(\"on filter ok\")\n            }\n          }\n        )\n      })\n    }\n    \n    return result.concat(defaultColumns);\n  }\n\n  const handleAddColumn = () => {\n    let newVariantValue = form.getFieldValue();\n    if (newVariantValue && newVariantValue.variantName) {\n      let newVariantId = 'v' + new Date().getTime();\n      setProductVariants({...productVariants, [newVariantId]: newVariantValue.variantName})\n      form.resetFields()\n    }\n    setNewColModal(false);\n  }\n\n  const handleRemoveColumn = (selectedCol) => {\n    const {[selectedCol]: removedCol, ...restVariant} = productVariants;\n    setProductVariants(restVariant)\n    \n    let newInventory = inventoryData.map((anInventory)=>{\n      delete anInventory[selectedCol];\n      return anInventory;\n    })\n    setInventoryData(newInventory)\n  }\n\n  const handleUpdatePublished = (selectedRow, checked, e) => {\n    e.preventDefault();\n    let updateIndex = inventoryData.map((aData)=>aData.key).indexOf(selectedRow.key);\n    setInventoryData(update(inventoryData, {[updateIndex]: {published: {$set: checked}}}));\n  }\n\n  const handleDeleteRow = key => {\n    setInventoryData(inventoryData.filter(item => item.key !== key))\n  };\n\n  const handleAddRow = () => {\n    let newId = new Date().getTime()\n    let defaultData = {\n      key: newId,\n      _id: null,\n      price: 0,\n      stock: 0,\n      published: false,\n      productId: productId\n    };\n    let result = defaultData;\n    if (inventoryData.length > 0) {\n      const {key, _id, published, ...rest} = inventoryData[inventoryData.length - 1];\n      result = {...result, ...rest};\n    }\n    \n    setInventoryData([...inventoryData, result]);\n  };\n\n  const handleSave = row => {\n    const newData = [...inventoryData];\n    const index = newData.findIndex(item => row.key === item.key);\n    const item = newData[index];\n    newData.splice(index, 1, { ...item, ...row });\n    setInventoryData(newData);\n  };\n\n  const components = {\n    body: {\n      row: EditableRow,\n      cell: EditableCell,\n    },\n  };\n  const columnsObj = getColumns().map(col => {\n    if (!col.editable) {\n      return col;\n    }\n\n    return {\n      ...col,\n      onCell: record => ({\n        record,\n        editable: col.editable,\n        dataIndex: col.dataIndex,\n        title: col.title,\n        isVariant: col.isVariant,\n        handleSave: handleSave,\n      }),\n    };\n  });\n\n  const onSelectChange = (selectedRowKeys,selectedRows) => {\n    setSelectedRows(selectedRowKeys);\n  };\n\n  const rowSelection = {\n    selectedRows,\n    onChange: onSelectChange,\n    fixed: true\n  };\n\n  return (\n    <div className=\"inventoryTable-main\">\n      <Button\n        onClick={handleAddRow}\n        type=\"primary\"\n        style={{\n          marginRight: 16,\n          marginBottom: 16,\n        }}\n        disabled={inventoryData.length < maxInventory ? false : true}\n        icon={<PlusOutlined/>}\n      >\n        Item\n      </Button>\n      \n      <Table\n        //rowKey={'_id'}\n        components={components}\n        rowClassName={() => 'editable-row'}\n        bordered\n        dataSource={inventoryData}\n        columns={columnsObj}\n        //rowSelection={rowSelection}\n        size={\"small\"}\n        pagination={false}\n        scroll={{ x: (columnsObj.length - 4) * 150 }}\n      />\n        {/* footer={(currentPageData)=>{\n          return (\n            <div>Selecting {selectedRows.length} of {inventoryData.length}</div>\n          )\n        }} */}\n      <Form form={form}>\n      <Modal\n        title=\"New Variant\"\n        width={300}\n        bodyStyle={{paddingBottom: 0}}\n        visible={newColModal}\n        onOk={handleAddColumn}\n        onCancel={()=>{setNewColModal(false)}}\n        //forceRender\n      >\n       \n          <Form.Item \n            name=\"variantName\"\n            rules={[\n              {\n                required: true,\n                message: `Name is required.`,\n              }\n            ]}\n          >\n            <Input maxLength={8}/>\n          </Form.Item>\n      </Modal>\n      </Form>\n    </div>\n  );\n}\n\n\nexport default InventoryFormTable;","import ApolloClient from 'apollo-client';\nimport { InMemoryCache } from 'apollo-cache-inmemory';\nimport { HttpLink } from 'apollo-link-http';\nimport gql from 'graphql-tag';\n\nimport { MIDDLETIER_URL } from './Constants';\n\nexport default function ApolloClientAPI(middletierURL = null) {\n  const cache = new InMemoryCache({ addTypename: false });\n  const client = new ApolloClient({\n    cache,\n    link: new HttpLink({\n        uri: middletierURL ? middletierURL : MIDDLETIER_URL,\n        credentials: \"include\"\n    })\n  });\n\n  return {\n    client: client,\n    cache: cache,\n    query: async (query, params={})=>{\n      return new Promise((resolve, reject) => {\n        client.query({\n          variables: params,\n          query: query\n        }).then(result=>{\n          resolve(result);\n        }).catch(err=>{\n          reject(err);\n        })\n      })\n    },\n    mutation: async (query, params={})=>{\n      return new Promise((resolve, reject) => {\n        client.mutate({\n          variables: params,\n          mutation: query\n        }).then(result=>{\n          resolve(result);\n        }).catch(err=>{\n          reject(err);\n        })\n      })\n    },\n  }\n}\n","import * as qiniu from 'qiniu-js';\nimport ApolloClientAPI from './ApolloClientAPI';\nimport gql from 'graphql-tag';\n\nconst QINIU_UPLOAD_TOKEN_STATE = gql`\n  {\n    qiniu @client {\n      success\n      message\n      data\n    }\n  }\n`;\n\nconst QINIU_UPLOAD_TOKEN_QUERY = gql`\n  {\n    qiniuToken {\n      success\n      message\n      data\n    }\n  }\n`;\n\nconst QINIU_BATCH_DELETE_QUERY = gql`\n  mutation qiniuBatchDelete($images: [String!]) {\n    qiniuBatchDelete(images: $images) {\n      success\n      message\n      data\n    }\n  }\n`;\n\nconst qiniuAPI = async (loadToken = true) => {\n  const apolloClient = ApolloClientAPI();\n  let qiniuToken = \"\";\n  if (loadToken) {\n    qiniuToken = await apolloClient.query(QINIU_UPLOAD_TOKEN_QUERY).then(result=>result).catch(err=>{});\n  }\n  return {\n    upload: async (file) => {\n      let fileObj = file.originFileObj\n      var config = {\n        useCdnDomain: true,\n        region: qiniu.region.z0\n      };\n      var putExtra = {\n        fname: \"\",\n        params: {},\n        mimeType: [\"image/png\", \"image/jpeg\", \"image/gif\"]\n      };\n      let key = file.name;\n      return new Promise((resolve, reject) => {\n        if (qiniuToken) {\n          let response = qiniuToken.data.qiniuToken;\n          if (response.success) {\n            let uploadToken = response.data;\n            let observable = qiniu.upload(fileObj, key, uploadToken, putExtra, config)\n\n            observable.subscribe({\n              next(res){\n                console.log('next(res)',res)\n              },\n              error(err){\n                console.log('error(err)',err)\n                reject(err)\n              }, \n              complete(res){\n                console.log('complete(res)',res)\n                resolve(res)\n              }\n            })\n          }\n        }\n        else {\n          reject(\"Error getting token\")\n        }\n        // apolloClient.query(QINIU_UPLOAD_TOKEN_STATE).then(result=>{\n        //   console.log('result',result)\n        //   let response = result.data.qiniu;\n        //   if (response.success) {\n        //     let uploadToken = response.data;\n        //     let observable = qiniu.upload(fileObj, key, uploadToken, putExtra, config)\n          \n        //     observable.subscribe({\n        //       next(res){\n        //         //console.log('next(res)',res)\n        //       },\n        //       error(err){\n        //         console.log('error(err)',err)\n        //         reject(err)\n        //       }, \n        //       complete(res){\n        //         console.log('complete(res)',res)\n        //         resolve(res)\n        //       }\n        //     })\n        //   }\n        // }).catch(err=>{\n        //   console.log('cached qiniu token not found',err)\n          \n        //   apolloClient.query(QINIU_UPLOAD_TOKEN_QUERY).then(result2=>{\n        //     console.log('result2',result2)\n        //     // apolloClient.client.writeQuery({ UPDATE_QINIU_UPLOAD_TOKEN_QUERY, data });\n        //     apolloClient.cache.writeData({data: {qiniu:result2.data.qiniuToken}})\n        //     let response2 = result2.data.qiniuToken;\n        //     if (response2.success) {\n        //       let uploadToken = response2.data;\n        //       let observable = qiniu.upload(fileObj, key, uploadToken, putExtra, config)\n  \n        //       observable.subscribe({\n        //         next(res){\n        //           console.log('next(res)',res)\n        //         },\n        //         error(err){\n        //           console.log('error(err)',err)\n        //           reject(err)\n        //         }, \n        //         complete(res){\n        //           console.log('complete(res)',res)\n        //           resolve(res)\n        //         }\n        //       })\n        //     }\n        //   }).catch(err2=>{\n        //     console.log('err2',err2)\n        //     reject(err2)\n        //   })\n        // })\n\n      })\n\n    },\n    batchDelete: async (images) => {\n      return new Promise((resolve, reject) => {\n        apolloClient.mutation(QINIU_BATCH_DELETE_QUERY,{\n          images: images\n        })\n        .then(result=>resolve(result))\n        .catch(err=>{\n          console.log(err);\n          reject(err)\n        });\n      })\n    },\n\n    imageMogr2: (options, key, domain) => {\n      return qiniu.imageMogr2(options, key, domain);\n    }\n  }\n}\n\nexport default qiniuAPI;","import React, {useState, useEffect} from 'react';\nimport { Button, Form, Input, Upload, Modal, Switch, Collapse, Select, Divider } from 'antd';\nimport { useLazyQuery, useMutation, useApolloClient } from \"@apollo/react-hooks\";\nimport { PlusOutlined, StarOutlined, StarFilled } from '@ant-design/icons';\nimport gql from \"graphql-tag\";\n\nimport confirmation from '../../../utils/component/confirmation';\nimport InventoryFormTable from './InventoryFormTable';\n\nimport qiniuAPI from '../../../utils/qiniuAPI';\nimport { useConfigCache } from '../../../utils/Constants';\n// import ApolloClientAPI from '../../../utils/ApolloClientAPI';\n\nconst { Panel } = Collapse;\nconst { Option } = Select;\n\nconst READ_PRODUCT_INVENTORY_QUERY = gql`\n  query inventory($filter: JSONObject) {\n    inventory(filter: $filter) {\n      _id\n      createdAt\n      updatedAt\n      price\n      stock\n      variants\n      published\n      productId\n    }\n  }\n`;\n\nconst BULK_UPDATE_INVENTORY_QUERY = gql`\n  mutation bulkUpdateInventory($inventory: [JSONObject!]) {\n    bulkUpdateInventory(inventory: $inventory) {\n      success\n      message\n      data\n    }\n  }\n`;\n\nconst CREATE_NEW_PRODUCT_QUERY = gql`\n  mutation createProduct($product: JSONObject!) {\n    createProduct(product: $product) {\n      success\n      message\n      data\n    }\n  }\n`;\n\nconst DELETE_PRODUCT_QUERY = gql`\n  mutation deleteProduct($_id: String!) {\n    deleteProduct(_id: $_id) {\n      success\n      message\n      data\n    }\n  }\n`;\n\nconst UPDATE_PRODUCT_QUERY = gql`\n  mutation updateProduct($product: JSONObject!) {\n    updateProduct(product: $product) {\n      success\n      message\n      data\n    }\n  }\n`;\n\n// convert db image obj to match Upload Component format\nconst getDefaultImageArray = (array, config) => {\n  let imageSrc = config.imageSrc;\n  return array.map((anImage)=>{\n    anImage['uid'] = anImage.name;\n    anImage['url'] = imageSrc + anImage.name;\n    anImage['thumbUrl'] = imageSrc + anImage.name;\n    if (anImage.fav) {\n      //anImage['status'] = 'done';\n    }\n    return anImage;\n  })\n}\n\n// mainly for image upload/delete in qiniu\nconst getImageFilesToModify = (defaultArray = [], newArray = []) => {\n  let newImageToUpload = [];\n  let currentUploadedImages = [];\n  let imagesToDelete = []\n  let allImages = []\n\n  newArray.map((anImage,index)=>{\n    // new image to be uploaded\n    let newImageName = anImage.name;\n    if (anImage.originFileObj) {\n      let imageNameSplited = newImageName.split('.');\n      newImageName = `saas_${index}_${new Date().getTime()}_${imageNameSplited[imageNameSplited.length - 2]}.${imageNameSplited[imageNameSplited.length - 1]}`;\n      anImage['name'] = newImageName;\n      newImageToUpload.push(anImage)\n    }\n    // uploaded images\n    else {\n      currentUploadedImages.push(anImage)\n    }\n    // convert Upload Component image obj to match db format\n    allImages.push({\n      name: newImageName,\n      fav: anImage.fav ? anImage.fav : false\n    })\n  });\n\n  defaultArray.map((anImage)=>{\n    let foundIndex = currentUploadedImages.map((anUploadedImage)=>anUploadedImage.name).indexOf(anImage.name);\n    if (foundIndex < 0) {\n      imagesToDelete.push(anImage);\n    }\n  })\n\n  return {\n    upload: newImageToUpload,\n    delete: imagesToDelete,\n    allImages: allImages,\n    uploaded: defaultArray\n  };\n}\n\nfunction getBase64(file) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.readAsDataURL(file);\n    reader.onload = () => resolve(reader.result);\n    reader.onerror = error => reject(error);\n  });\n}\n\nconst ProductInfoForm = (props) => {\n  const {product = null, categories, refetch, ...modalProps} = props;\n  const config = useConfigCache();\n  const fileLimit = 4;\n\n  const [ form ] = Form.useForm();\n  const [ fileList, setFileList ] = useState([]);\n  const [ previewVisible, setPreviewVisible ] = useState(false);\n  const [ previewImage, setPreviewImage ] = useState(null);\n\n  // inventory\n  const [ inventoryData, setInventoryData ] = useState([]);\n  const [ productCategory, setProductCategory ] = useState(categories);\n  const [ newCategoryName, setNewCategoryName ] = useState('');\n  const [ productVariants, setProductVariants ] = useState({'sku': 'SKU'});\n\n  useEffect(() => {\n    if (product && modalProps.modalVisible) {\n      let productObj = Object.assign({},product);\n      if (product.category && product.category.length > 0) {\n        let newCategoryFormat = product.category.map((aCategory)=>{\n          return {\n            key: aCategory._id,\n            label: aCategory.name\n          }\n        })\n        productObj['category'] = newCategoryFormat;\n      }\n      form.setFieldsValue(productObj);\n      if (product.variants) {\n        setProductVariants(product.variants)\n      }\n\n      readInventory({\n        variables: {\n          filter: {\n            filter: { productId: product._id }\n          }\n        }\n      });\n      if (product.images && product.images.length > 0) {\n        setFileList(getDefaultImageArray(product.images, config));\n      }\n    }\n    else {\n      form.resetFields();\n    }\n    modalProps.setModalFooter(getModalFooter());\n    \n  }, [product, modalProps.modalVisible]);\n\n  const uploadButton = (\n    <div>\n      <PlusOutlined />\n      <div className=\"ant-upload-text\">Upload</div>\n    </div>\n  );\n\n  const handleFileListChange = ({ fileList, ...rest }) => {\n    let result = fileList.map((aFile)=>{\n      if (aFile.fav) {\n        //aFile['status'] = 'done';\n      }\n      return aFile;\n    });\n    if (fileList.length > fileLimit) {\n      result = fileList.slice(0, fileLimit-1);\n    }\n    if (result.length > 0) {\n      let foundFavImage = result.find((anImage)=>anImage.fav);\n      if (!foundFavImage) {\n        result[0]['fav'] = true;\n      }\n    }\n    setFileList(result)\n  };\n\n  const handleFavImageChange = () => {\n    let newFileList = [].concat(fileList)\n    newFileList.map((aFile)=>{\n      if (aFile.name == previewImage.name) {\n        aFile['fav'] = true;\n      }\n      else {\n        aFile['fav'] = false;\n      }\n      return aFile;\n    });\n    setFileList(newFileList);\n  }\n\n  const handlePreviewOpen = async (file) => {\n    if (!file.url && !file.preview) {\n      file.preview = await getBase64(file.originFileObj);\n    }\n    setPreviewVisible(true);\n    setPreviewImage(file);\n  };\n\n  const handlePreviewClose = () => {\n    setPreviewVisible(false);\n  }\n\n  const [readInventory, readInventoryResult ] = useLazyQuery(READ_PRODUCT_INVENTORY_QUERY,{\n    fetchPolicy: \"cache-and-network\",\n    onCompleted: (result) => {\n      if (result && result.inventory) {\n        let flattenedInventory = [];\n        result.inventory.map((anInventory,index)=>{\n          const { variants, ...restInventory } = anInventory;\n          let newInventory = {...restInventory, ...variants, key: restInventory._id};\n          flattenedInventory.push(newInventory);\n        })\n        setInventoryData(flattenedInventory);\n      }\n\n    }\n  })\n\n  const [bulkUpdateInventory] = useMutation(BULK_UPDATE_INVENTORY_QUERY,{\n    onCompleted: (result) => {\n      // console.log(\"bulkUpdateInventory result\",result)\n    }\n  })\n\n  const [createProduct, createProductResult ] = useMutation(CREATE_NEW_PRODUCT_QUERY,{\n    onCompleted: (result) => {\n      // console.log(\"createProduct result\",result)\n      modalProps.onCancel();\n      refetch();\n    }\n  })\n  const [deleteProduct] = useMutation(DELETE_PRODUCT_QUERY,{\n    onCompleted: (result) => {\n      // console.log(\"deleteProduct result\",result)\n      modalProps.onCancel();\n      refetch();\n    }\n  })\n  const [updateProduct, updateProductResult ] = useMutation(UPDATE_PRODUCT_QUERY,{\n    onCompleted: (result) => {\n      // console.log(\"updateProduct result\",result)\n      modalProps.onCancel();\n      refetch();\n    }\n  })\n\n  const onFinish = async (values) => {\n    \n    let finalProductValue = {\n      ...values,\n      images: [], \n      variants: productVariants\n    }\n\n    if (!values._id) {\n      delete finalProductValue._id;\n    }\n    \n    if (values.category) {\n      let foundSelectedCategory = productCategory.find(aCategory=>aCategory._id == values.category.key);\n      if (foundSelectedCategory) {\n        finalProductValue['category'] = [foundSelectedCategory];\n      }\n    }\n    else {\n      finalProductValue['category'] = [];\n    }\n\n    let imagesToBeModified = getImageFilesToModify(product && product.images ? product.images : [], fileList);\n    // if (imagesToBeModified.upload.length > 0 || imagesToBeModified.delete.length > 0) {\n      finalProductValue['images'] = imagesToBeModified.allImages;\n    // }\n\n    const QiniuAPI = await qiniuAPI();\n\n    if (imagesToBeModified.upload.length > 0) {\n      imagesToBeModified.upload.map(async (aNewImage)=>{\n        await QiniuAPI.upload(aNewImage)\n      })\n    }\n    if (imagesToBeModified.delete.length > 0) {\n      await QiniuAPI.batchDelete(imagesToBeModified.delete.map(anImage=>anImage.name))\n    }\n\n    if (!product) {\n      createProduct({\n        variables: {\n          product: finalProductValue\n        }\n      })\n    }\n    else {\n\n      updateProduct({\n        variables: {\n          product: {...finalProductValue, _id: product._id}\n        }\n      })\n\n      let newInventory = [...inventoryData];\n      newInventory = newInventory.map((anInventory)=>{\n        const { key, ...restInventory} = anInventory;\n\n        //delete anInventory.key;\n        let variantObj = {}\n        Object.keys(productVariants).map((aKey)=>{\n          if (restInventory.hasOwnProperty(aKey)) {\n            variantObj[aKey] = restInventory[aKey];\n            delete restInventory[aKey];\n          }\n        });\n        restInventory['variants'] = variantObj;\n        return restInventory;\n      });\n      let deletedInventory = []\n      if (readInventoryResult.data && readInventoryResult.data.inventory) {\n        readInventoryResult.data.inventory.map((anInventory)=>{\n          let foundInventory = newInventory.map((aNewInventory)=>{return aNewInventory._id}).indexOf(anInventory._id);\n          if (foundInventory < 0) {\n            deletedInventory.push({...anInventory, deleted: true});\n          }\n        })\n      } \n\n      bulkUpdateInventory(\n        {\n          variables: {\n            inventory: newInventory.concat(deletedInventory)\n          }\n        }\n      )\n\n    }\n  }\n\n  const onDeleteProduct = () => {\n    confirmation('confirm',\"Confirm delete?\",async ()=>{\n      if (product.images && product.images.length > 0) {\n        const QiniuAPI = await qiniuAPI();\n        await QiniuAPI.batchDelete(product.images.map(anImage=>anImage.name))\n      }\n      deleteProduct({variables:{_id: product._id}})\n    })\n  }\n\n  // const checkFormTouched = () => {\n  //   console.log('isFieldsTouched',form.isFieldTouched('name'));\n  // }\n\n  const onCategoryNameChange = (e) => {\n    setNewCategoryName(e.target.value);\n  }\n\n  const addNewCategory = () => {\n    if (newCategoryName && newCategoryName != \"\") {\n      setProductCategory([...productCategory, {\n        _id: `category_${newCategoryName}_${new Date().getTime()}`,\n        name: newCategoryName\n      }]);\n      setNewCategoryName('')\n    }\n  }\n\n  const getModalFooter = () => {\n    const modalFooter = [\n      <Button key={'cancel'} onClick={modalProps.onCancel}>\n        Cancel\n      </Button>,\n      <Button key={'submit'} type=\"primary\" onClick={()=>{form.submit()}}>\n        {product ? \"Save\" : \"Save\"}\n      </Button>\n    ]\n  \n    if (product) {\n      modalFooter.unshift(\n        <Button key={'delete'} type=\"danger\" onClick={onDeleteProduct}>\n          Delete\n        </Button>\n      )\n    }\n    return modalFooter;\n  }\n\n  const getPreviewModalFooter = () => {\n    let isFav = previewImage && previewImage.fav;\n    return (\n      <Button \n        type={isFav ? 'primary': 'default'} \n        icon={isFav ? (<StarFilled style={{color: 'gold'}}/>) : (<StarOutlined/>) } \n        onClick={handleFavImageChange}\n      >\n        Favourite\n      </Button>\n    )\n  } \n\n  // const editImageOutput = (image) => {\n  //   if (image) {\n  //     const QiniuAPI = qiniuAPI();\n  //     let imageSrc = config.imageSrc;\n  //     var imgLink = QiniuAPI.imageMogr2({\n  //       \"auto-orient\": true,      // 布尔值，是否根据原图EXIF信息自动旋正，便于后续处理，建议放在首位。\n  //       strip: true,              // 布尔值，是否去除图片中的元信息\n  //       thumbnail: '1000x1000',    // 缩放操作参数\n  //       crop: '!300x400a10a10',    // 裁剪锚点参数\n  //       quality: 40,              // 图片质量，取值范围1-100\n  //       rotate: 20,               // 旋转角度，取值范围1-360，缺省为不旋转。\n  //       blur: '3x5'               // 高斯模糊参数\n  //     }, image.name, domain)\n  //   }\n  // }\n  return (\n    <div id=\"productForm\">\n      <Collapse \n        defaultActiveKey={['1','2']} \n        //bordered={false}\n        expandIconPosition=\"right\"\n      >\n        <Panel header=\"Product Information\" key=\"1\">\n          <Form \n            name=\"complex-form\" \n            form={form} \n            onFinish={onFinish} \n            labelCol={{ span: 5 }} \n            wrapperCol={{ span: 16 }} \n          >\n            {\n              !product ? (\n                <Form.Item name={'_id'} label=\"ID\">\n                  <Input />\n                </Form.Item> \n              ) : null\n            }\n            <Form.Item name={'name'} label=\"Name\" rules={[{ required: true }]}>\n              <Input />\n            </Form.Item>\n            <Form.Item name={'description'} label=\"Description\">\n              <Input.TextArea rows={4} />\n            </Form.Item>\n            <Form.Item name={'category'} label=\"Category\">\n              <Select\n                style={{ width: 240 }}\n                placeholder=\"Select a category\"\n                labelInValue={true}\n                allowClear={true}\n                dropdownRender={menu => (\n                  <div>\n                    {menu}\n                    <Divider style={{ margin: '4px 0' }} />\n                    <div style={{ display: 'flex', flexWrap: 'nowrap', padding: 8 }}>\n                      <Input style={{ flex: 'auto' }} value={newCategoryName} onChange={onCategoryNameChange} required={true}/>\n                      <Button\n                        type=\"link\"\n                        icon={<PlusOutlined />}\n                        onClick={addNewCategory}\n                        disabled={newCategoryName != \"\" ? false : true}\n                      >\n                        New\n                      </Button>\n                    </div>\n                  </div>\n                )}\n              >\n                {productCategory.map((item, index) => (\n                  <Option key={index} value={item._id}>{item.name}</Option>\n                ))}\n              </Select>\n            </Form.Item>\n            <Form.Item name={'published'} label=\"Published\" valuePropName=\"checked\">\n              <Switch checkedChildren=\"Active\" unCheckedChildren=\"Inactive\" />\n            </Form.Item>\n\n            <Form.Item name={'images'} label=\"Images\">\n              <React.Fragment>\n                <Upload\n                  accept=\"image/*\"\n                  beforeUpload={ (file) => {\n                    return false;\n                  }}\n                  listType=\"picture-card\"\n                  multiple={true}\n                  fileList={fileList}\n                  onPreview={handlePreviewOpen}\n                  onChange={handleFileListChange}\n                  //showUploadList={{\n                  //  showDownloadIcon: true,\n                  //  downloadIcon: <StarFilled style={{color: 'yellow'}}/>\n                  //}}\n                  className={'productForm-upload'}                >\n                  {fileList.length < fileLimit ? uploadButton : null}\n                </Upload>\n                <Modal \n                  visible={previewVisible} \n                  footer={getPreviewModalFooter()} \n                  onCancel={handlePreviewClose}>\n                {/* <Modal visible={previewVisible} footer={null} onCancel={handlePreviewClose}> */}\n                  <img alt={`preview: ${previewImage ? previewImage.name : \"\"}`} style={{ width: '100%' }} src={previewImage ? previewImage.url || previewImage.thumbUrl : ''} />\n                  {/* <img alt=\"example\" style={{ width: '100%' }} src={()=>{editImageOutput(previewImage)}} /> */}\n                </Modal>\n              </React.Fragment>\n            </Form.Item>\n          </Form> \n\n        </Panel>\n        {\n          product ? (\n            <Panel header=\"Pricing & Variants\" key=\"2\">\n              <InventoryFormTable\n                productId={product._id}\n                inventoryData={inventoryData}\n                setInventoryData={setInventoryData}\n                productVariants={productVariants}\n                setProductVariants={setProductVariants}\n              />\n            </Panel>\n          ) : null\n        }\n        {/* {\n          product ? (\n            <Panel header=\"Related Products\" key=\"3\">\n              \n            </Panel>\n          ) : null\n        } */}\n      </Collapse>\n    </div>\n  )\n}\n\nconst ProductForm = (props) => {\n  const { product, categories = [], modalVisible, refetch, closeModal } = props;\n  const [ modalFooter, setModalFooter ] = useState([]);\n\n  let modalProps = {}\n  if (modalFooter) {\n    modalProps['footer'] = modalFooter;\n  }\n\n  return (\n    <Modal\n      title={product ? product.name : \"New Product\"}\n      width={'95%'}\n      visible={modalVisible}\n      onCancel={closeModal}\n      destroyOnClose\n      wrapClassName={'products-modalWrapper'}\n      //bodyStyle={{paddingLeft:'0'}} //for left tab\n      style={{overflow:\"hidden\"}}\n      //bodyStyle={{paddingTop:'0'}}\n      {...modalProps}\n    >\n      <ProductInfoForm\n        // product props\n        product={product} \n        categories={categories}\n        refetch={refetch}\n\n        // modal props\n        modalVisible={modalVisible}\n        onCancel={closeModal}\n        setModalFooter={setModalFooter}\n      />\n    </Modal>\n  )\n}\nexport default ProductForm;","import React, {useState} from 'react';\nimport Page_01 from './component/Page_01';\nimport { useQuery } from \"@apollo/react-hooks\";\nimport gql from \"graphql-tag\";\nimport { Button, Modal, Empty } from 'antd';\nimport {\n  PlusOutlined\n} from '@ant-design/icons';\nimport ProductForm from './component/ProductForm';\nimport ProductCard from './component/ProductCard';\nimport Loading from '../../utils/component/Loading';\n\nconst GET_PRODUCTS_QUERY = gql`\n  query products($filter: JSONObject) {\n    products(filter: $filter) {\n      _id\n      createdAt\n      updatedAt\n      name\n      description\n      category\n      variants\n      published\n      images\n    }\n  }\n`;\n\nconst Products = (props) => {\n  const [ productFormModal, setProductFormModal ] = useState(false);\n  const [ selectedProduct, setSelectedProduct ] = useState(null);\n\n  const { data, loading, error, refetch } = useQuery(GET_PRODUCTS_QUERY, {\n    fetchPolicy: \"cache-and-network\",\n    variables: {\n\n    },\n    onError: (error) => {\n      console.log(\"products error\", error)\n\n    },\n    onCompleted: (result) => {\n      \n    }\n  });\n\n  const handleProductFormModalOpen = () => {\n    setProductFormModal(true);\n  }\n  const handleProductFormModalClose = () => {\n    setProductFormModal(false);\n  }\n\n  const handleOnClickProduct = (product) => {\n    handleProductFormModalOpen();\n    setSelectedProduct(product)\n  }\n\n  const getProducts = (dataInput) => {\n    let result = [];\n    dataInput.products.map((aProduct, index)=>{\n      result.push(\n        <li key={index} className=\"products-card-item\" onClick={()=>{handleOnClickProduct(aProduct)}}>\n          <ProductCard product={aProduct}/>\n        </li>\n      )\n    })\n    return result;\n  }\n\n  return (\n    <Page_01\n      title={\"Products\"}\n      extra={[\n        <Button key=\"create\" type=\"primary\" icon={<PlusOutlined />} onClick={()=>{handleOnClickProduct(null)}} />\n      ]}\n    >\n      <ul className=\"products-container\">\n        {\n          loading ? <Loading/> \n          : (error ? \"Error\" \n            : (data.products.length > 0 ? getProducts(data) : <li style={{width:'100%'}}><Empty/></li> ))\n        }\n      </ul>\n      <ProductForm\n          // product props\n          product={selectedProduct} \n          refetch={refetch}\n\n          // modal props\n          modalVisible={productFormModal}\n          closeModal={handleProductFormModalClose}\n        />\n    </Page_01>\n  )\n}\n\nexport default Products;\n","import React, {useState, useEffect} from 'react';\nimport { useQuery, useMutation } from \"@apollo/react-hooks\";\nimport gql from \"graphql-tag\";\nimport { Button, Table, Tag, message } from 'antd';\nimport {\n  PlusOutlined\n} from '@ant-design/icons';\nimport { format } from 'date-fns';\n\nimport Page_01 from './component/Page_01';\nimport Loading from '../../utils/component/Loading';\nimport ProductForm from './component/ProductForm';\n\nconst GET_PRODUCTS_QUERY = gql`\n  query products($filter: JSONObject) {\n    products(filter: $filter) {\n      _id\n      createdAt\n      updatedAt\n      name\n      description\n      category\n      variants\n      published\n      images\n    }\n  }\n`;\n\nconst READ_PRODUCT_INVENTORY_QUERY = gql`\n  query inventory($filter: JSONObject) {\n    inventory(filter: $filter) {\n      _id\n      createdAt\n      updatedAt\n      price\n      stock\n      variants\n      published\n      productId\n    }\n  }\n`;\n\nconst UPDATE_PRODUCT_PUBLISH = gql`\n  mutation updateProductPublish($ids: [String!], $published: Boolean!) {\n    updateProductPublish(ids: $ids, published: $published) {\n      success\n      message\n      data\n    }\n  }\n`;\n\nconst UPDATE_INVENTORY_PUBLISH = gql`\n  mutation updateInventoryPublish($ids: [String!], $published: Boolean!) {\n    updateInventoryPublish(ids: $ids, published: $published) {\n      success\n      message\n      data\n    }\n  }\n`;\n\nconst getAllProductCategory = (products) => {\n  let result = [];\n  products.map((aProduct)=>{\n    if (aProduct.category && aProduct.category.length > 0) {\n      aProduct.category.map((aCategory)=>{\n        let foundPushedItem = result.find((anItem)=>anItem._id == aCategory._id);\n        if (!foundPushedItem) {\n          result.push(aCategory);\n        }\n      })\n    }\n  });\n  return result;\n}\n\nconst Inventory = (props) => {\n  const [ productFormModal, setProductFormModal ] = useState(false);\n  const [ selectedProduct, setSelectedProduct ] = useState(null);\n\n  const [ selectedItems, setSelectedItems ] = useState([]);\n  const [ displaySelectionPanel, setDisplaySelectionPanel ] = useState(false);\n\n  const { data: productsData, loading, error, refetch: refetchProducts } = useQuery(GET_PRODUCTS_QUERY, {\n    fetchPolicy: \"cache-and-network\",\n    variables: {\n      // filter: {\n      //   sorter: {\n      //     createdAt: 1\n      //   }\n      // }\n    },\n    onError: (error) => {\n      console.log(\"products error\", error)\n\n    },\n    onCompleted: (result) => {\n      \n    }\n  });\n\n  const { data: inventoryData, loading: inventoryLoading, error: inventoryError, refetch: refetchInventory } = useQuery(READ_PRODUCT_INVENTORY_QUERY, {\n    fetchPolicy: \"cache-and-network\",\n    onError: (error) => {\n      console.log(\"inventoryData error\", error)\n    },\n    onCompleted: (result) => {\n      // console.log('inventoryData', result)\n    }\n  });\n\n  const [updateProductPublish] = useMutation(UPDATE_PRODUCT_PUBLISH,{\n    onCompleted: (result) => {\n      refetchProducts();\n    }\n  });\n  const [updateInventoryPublish] = useMutation(UPDATE_INVENTORY_PUBLISH,{\n    onCompleted: (result) => {\n      refetchInventory();\n    }\n  });\n\n\n  useEffect(()=>{\n    if (selectedItems.length > 0) {\n      if (!displaySelectionPanel) setDisplaySelectionPanel(true);\n    }\n    else {\n      if (displaySelectionPanel) setDisplaySelectionPanel(false)\n    }\n  },[selectedItems.length])\n\n\n  const handleProductFormModalOpen = () => {\n    setProductFormModal(true);\n  }\n  const handleProductFormModalClose = () => {\n    setProductFormModal(false);\n  }\n\n  const handleOnClickProduct = (product) => {\n    handleProductFormModalOpen();\n    setSelectedProduct(product)\n  }\n\n  const refetchData = () => {\n    refetchProducts();\n    refetchInventory();\n  }\n\n\n  let columns = [\n    {\n      title: 'No.',\n      dataIndex: 'index',\n      width: 75,\n      render: (text, record, index) => {\n        return index + 1 + '.';\n      }\n    },\n    {\n      title: \"Created At\",\n      dataIndex: 'createdAt',\n      key: 'createdAt',\n      sorter: (a, b) => new Date(a.createdAt) - new Date(b.createdAt),\n      render: (text, record) => {\n        let dateTime = format(new Date(text), \"MM/dd/yyyy hh:mm:ss aa\")\n        return dateTime;\n      }\n    },\n    {\n      title: 'Name',\n      dataIndex: 'name',\n      render: (text, record) => {\n        let result = record.name ? (<Button type=\"link\" onClick={()=>{handleOnClickProduct(record)}}>{record.name}</Button>) : null;\n        if (!result) {\n          let newName = \"\";\n          if (record.variants) {\n            \n            let variantKeys = Object.keys(record.variants);\n            variantKeys.map((aKey, index)=>{\n              newName += `${record.variants[aKey]} ${index == variantKeys.length - 1 ? \"\" : \"/ \"}`\n            })\n          }\n          else {\n            newName = \"-\";\n          }\n          result = newName;\n        }\n        return result;\n      }\n    },\n    {\n      title: 'Price',\n      dataIndex: 'price',\n      render: (text, record) => {\n        let result = record.price;\n        if (!result) {\n          result = '-';\n        }\n        return result;\n      }\n    },\n    {\n      title: 'Stock',\n      dataIndex: 'stock',\n      sorter: (a, b) => {\n        if (a.stock && b.stock) {\n          return a.stock - b.stock\n        }\n        return 0;\n      },\n      render: (text, record) => {\n        let result = record.stock;\n        if (!result) {\n          if (record.children && record.children.length > 0) {\n            let sum = 0;\n            record.children.map((aChild)=>{sum += aChild.stock});\n            result = sum;\n          }\n          else {\n            result = '-';\n          }\n        }\n        return result;\n      }\n    },\n    {\n      title: 'Published',\n      dataIndex: 'published',\n      render: (text, record) => {\n        return (\n          record.published ? <Tag color=\"green\">Active</Tag> : <Tag color=\"red\">Inactive</Tag>\n        )\n      } \n    }\n  ]\n\n  \n\n  const selectionPanel = () => {\n    let inventoryIds = [];\n    let productIds = [];\n    selectedItems.map((anItem)=>{\n      if (anItem.productId && anItem.productId != \"\") {\n        inventoryIds.push(anItem._id)\n      }\n      else {\n        productIds.push(anItem._id)\n      }\n    });\n  \n    const updateToPublish = () => {\n      if (inventoryIds.length > 0) {\n        updateInventoryPublish({\n          variables: {\n            ids: inventoryIds,\n            published: true\n          }\n        })\n      }\n      if (productIds.length > 0) {\n        updateProductPublish({\n          variables: {\n            ids: productIds,\n            published: true\n          }\n        })\n      }\n    }\n    const updateToUnpublish = () => {\n      if (inventoryIds.length > 0) {\n        updateInventoryPublish({\n          variables: {\n            ids: inventoryIds,\n            published: false\n          }\n        })\n      }\n      if (productIds.length > 0) {\n        updateProductPublish({\n          variables: {\n            ids: productIds,\n            published: false\n          }\n        })\n      }\n    }\n    return (\n      <div style={{display: 'flex'}}>\n        <Button type=\"primary\" size=\"small\" onClick={updateToPublish} style={{marginRight: '5px'}} disabled={!displaySelectionPanel}>Publish</Button>\n        <Button size=\"small\" onClick={updateToUnpublish} disabled={!displaySelectionPanel}>Unpublish</Button>\n      </div>\n    )\n  }\n\n  const rowSelection = {\n    onChange: (selectedRowKeys, selectedRows) => {\n      setSelectedItems(selectedRows);\n      // console.log(`selectedRowKeys: ${selectedRowKeys}`, 'selectedRows: ', selectedRows);\n    },\n    onSelect: (record, selected, selectedRows) => {\n      // console.log(record, selected, selectedRows);\n    },\n    onSelectAll: (selected, selectedRows, changeRows) => {\n      // console.log(selected, selectedRows, changeRows);\n    },\n  };\n\n  const getTableData = () => {\n    let result = [];\n    if (productsData && inventoryData && !error && !inventoryError) {\n      let inventoryWithKey = inventoryData.inventory.map((anInventory)=>{ return {...anInventory, key: anInventory._id} });\n      productsData.products.map((aProduct,index)=>{\n        let productInventory = inventoryWithKey.filter((anInventory)=>anInventory.productId == aProduct._id);\n        aProduct['key'] = aProduct._id;\n        if (productInventory.length > 0) {\n          aProduct['children'] = productInventory;\n        }\n        result.push(aProduct)\n      });\n    }\n    return result;\n  }\n\n  let hasSelected = selectedItems.length > 0 ? true : false;\n\n  return (\n    <Page_01\n      title={\"Inventory\"}\n      extra={[\n        <Button key=\"create\" type=\"primary\" icon={<PlusOutlined />} onClick={()=>{handleOnClickProduct(null)}} />\n      ]}\n    >\n      <Table \n        columns={columns} \n        rowSelection={rowSelection} \n        dataSource={getTableData()} \n        pagination={false}\n        scroll={{x: columns.length * 150}}\n        size={'small'}\n      />\n      <div className={`inventory-selectionPanel ${displaySelectionPanel ? 'open' : 'close'}`}>\n        {selectionPanel()}\n      </div>\n\n      <ProductForm\n        // product props\n        product={selectedProduct} \n        categories={productsData && productsData.products ? getAllProductCategory(productsData.products) : []}\n        refetch={refetchData}\n\n        // modal props\n        modalVisible={productFormModal}\n        closeModal={handleProductFormModalClose}\n      />\n    </Page_01>\n  )\n}\n\nexport default Inventory;\n","import React from 'react';\nimport { Modal, Divider, Descriptions, List, Avatar } from 'antd';\nimport { format } from 'date-fns';\n\nimport { useConfigCache } from '../../../utils/Constants';\n\n\nconst OrderInfo = (props) => {\n  const { order, closeModal, visible, ... restProps } = props;\n  const config = useConfigCache();\n\n  const orderItems = (item) => {\n    let title = item.product.name;\n    let variant = \"\";\n    let variantKeys = Object.keys(item.variant);\n    variantKeys.map((aKey, index)=>{\n      variant += `${aKey}: ${item.variant[aKey]}${index == variantKeys.length -1 ? \"\" : \", \"}`\n    })\n\n    let imageSrc = \"\";\n    if (config && item.product.image) {\n      imageSrc = config.imageSrc + item.product.image;\n    }\n    return (\n      <List.Item\n        actions={[\n          \"qty: \" + item.qty,\n          \"price: \" + item.price\n        ]}\n      >\n        <List.Item.Meta\n          avatar={\n            <Avatar shape=\"square\" src={imageSrc} />\n          }\n          title={title}\n          description={variant}\n        />\n      </List.Item>\n    )\n  }\n  return (\n    <Modal\n      title={\"Order\"}\n      width={'95%'}\n      visible={visible}\n      onCancel={closeModal}\n      footer={null}\n      //destroyOnClose\n      wrapClassName={'products-modalWrapper'}\n      style={{overflow:\"hidden\"}}\n    >\n    {\n      order ?\n      <React.Fragment>\n        <Divider orientation=\"left\">订单</Divider>\n        <Descriptions \n            size=\"small\"\n            bordered\n            column={{ xxl: 2, xl: 2, lg: 2, md: 2, sm: 1, xs: 1 }}\n        >\n            <Descriptions.Item label=\"编号\">{order._id}</Descriptions.Item>\n            <Descriptions.Item label=\"订购日期\">{format(new Date(order.createdAt), \"MM/dd/yyyy hh:mm:ss aa\")}</Descriptions.Item>\n            <Descriptions.Item label=\"付款状态\">\n                {\n                  order.paid ? \n                    <span style={{\"color\":\"green\"}}>已付款</span> : <span style={{\"color\":\"red\"}}>待付款</span>\n                }\n            </Descriptions.Item>\n            <Descriptions.Item label=\"货物状态\">{order.sentOut ? <span style={{\"color\":\"green\"}}>已出货 <small> (运单号: {order.trackingNum})</small></span>:<span style={{\"color\":\"red\"}}>未出货</span>}</Descriptions.Item>\n        </Descriptions>\n        <Divider orientation=\"left\">收件人</Divider>\n        <Descriptions \n            id=\"buyerInfoTable\"\n            size=\"small\"\n            bordered\n            column={{ xxl: 1, xl: 1, lg: 1, md: 1, sm: 1, xs: 1 }}\n        >\n            <Descriptions.Item label=\"名字\">{order.customer.name}</Descriptions.Item>\n            <Descriptions.Item label=\"电话号码\">contact</Descriptions.Item>\n            <Descriptions.Item label=\"收件地址\">address</Descriptions.Item>\n        </Descriptions>\n        <Divider orientation=\"left\">购买列表</Divider> \n        <List\n          itemLayout=\"horizontal\"\n          dataSource={order.items}\n          renderItem={orderItems}\n          //bordered\n          footer={(\n            <div className=\"orderInfo-item-summary\">\n              Total: {order.total}\n            </div>\n          )}\n        />\n      </React.Fragment>\n      : \"Not found\"\n    }\n  \n    </Modal>\n  )\n}\n\nexport default OrderInfo;","import React, {useState} from 'react';\nimport { Tabs, Table, Button, Input, Popconfirm } from 'antd';\nimport { format } from 'date-fns';\nimport gql from \"graphql-tag\";\nimport { useQuery, useMutation } from \"@apollo/react-hooks\";\nimport { CheckOutlined } from '@ant-design/icons';\n\nimport Page_01 from './component/Page_01';\nimport OrderInfo from './component/OrderInfo';\n\nconst { TabPane } = Tabs;\nconst { Search } = Input;\n\nconst GET_ORDERS_QUERY = gql`\n  query orders($filter: JSONObject) {\n    orders(filter: $filter) {\n      _id\n      createdAt\n      updatedAt\n      items\n      total\n      customer\n      paid\n      sentOut\n      trackingNum\n    }\n  }\n`;\n\nconst UPDATE_ORDER_PAYMENT_QUERY = gql`\n  mutation updateOrderPayment($_id: String!, $paid: Boolean!) {\n    updateOrderPayment(_id: $_id, paid: $paid) {\n      success\n      message\n      data\n    }\n  }\n`;\n\nconst UPDATE_ORDER_DELIVERY_QUERY = gql`\n  mutation updateOrderDelivery($_id: String!, $trackingNum: String) {\n    updateOrderDelivery(_id: $_id, trackingNum: $trackingNum) {\n      success\n      message\n      data\n    }\n  }\n`;\n\nconst CANCEL_ORDER_QUERY = gql`\n  mutation cancelOrder($_id: String!) {\n    cancelOrder(_id: $_id) {\n      success\n      message\n      data\n    }\n  }\n`;\nconst Orders = (props) => {\n\n  const [ orderModalDisplay, setOrderModalDisplay ] = useState(false);\n  const [ selectedOrder, setSelectedOrder ] = useState(null);\n\n  const { data, loading, error, refetch: refetchOrders } = useQuery(GET_ORDERS_QUERY, {\n    fetchPolicy: \"cache-and-network\",\n    variables: {\n      filter: {\n        sorter: {\n          createdAt: 'desc'\n        }\n      }\n    },\n    onError: (error) => {\n      console.log(\"products error\", error)\n\n    },\n    onCompleted: (result) => {\n      \n    }\n  });\n\n  const [ updateOrderPayment , updateOrderPaymentResult ] = useMutation(UPDATE_ORDER_PAYMENT_QUERY,{\n    onCompleted: (result) => {\n      refetchOrders()\n    }\n  })\n\n  const [ updateOrderDelivery , updateOrderDeliveryResult ] = useMutation(UPDATE_ORDER_DELIVERY_QUERY,{\n    onCompleted: (result) => {\n      refetchOrders()\n    }\n  })\n\n  const [ cancelOrder , cancelOrderResult ] = useMutation(CANCEL_ORDER_QUERY,{\n    onCompleted: (result) => {\n      refetchOrders()\n    }\n  })\n\n  const handleOrderModalDisplayOpen = (selectedOrder) => {\n    setOrderModalDisplay(true);\n    setSelectedOrder(selectedOrder)\n  }\n  const handleOrderModalDisplayClose = () => {\n    setOrderModalDisplay(false);\n  }\n\n  const defaultColumns = [\n    {\n      title: \"No.\",\n      dataIndex: 'index',\n      key: 'index',\n      width: 75,\n      render: (text, record, index) => {\n        return `${index + 1}.`;\n      }\n    },\n    {\n      title: \"订购日期\",\n      dataIndex: 'createdAt',\n      key: 'createdAt',\n      sorter: (a, b) => new Date(a.createdAt) - new Date(b.createdAt),\n      render: (text, record) => {\n        let dateTime = format(new Date(text), \"MM/dd/yyyy hh:mm:ss aa\")\n        return dateTime;\n      }\n    },\n    {\n      title: \"订单编号\",\n      dataIndex: '_id',\n      key: '_id',\n      render: (text, record) => {\n        return (\n          <a style={{whiteSpace:\"pre-wrap\", textDecoration:\"underline\"}} onClick={()=>{handleOrderModalDisplayOpen(record)}}>{record._id.toUpperCase()}</a>\n        )\n      }\n    },\n    {\n      title: \"收货人\",\n      dataIndex: 'customer',\n      key: 'customer',\n      sorter: (a, b) => a.name - b.name,\n      render: (text, record) => {\n        return text.name;\n      }\n    },\n    {\n      title: \"总计\",\n      dataIndex: 'total',\n      key: 'total',\n      sorter: (a, b) => a.total - b.total\n    }\n  ]\n\n  // {\n  //   title: \"货物状态\",\n  //   dataIndex: 'sentOut',\n  //   key: 'sentOut',\n  //   //width: 200,\n  //   render: (text, record) => {\n  //     return 'haha'\n  //   }\n  // },\n\n  let emptyTablePlaceholder = (\n      <div>空空如也</div>\n  )\n\n  const getColumnsByTable = () => {\n    \n    let tableCol1 = [...defaultColumns, ...[\n      {\n        title: \"付款状态\",\n        dataIndex: 'paid',\n        key: 'paid',\n        render: (text, record) => {\n          const handleUpdatePayment = () => {\n            updateOrderPayment({\n              variables: {\n                _id: record._id,\n                paid: !record.paid\n              }\n            })\n          }\n          return (<Button size=\"small\" type={`${text ? \"primary\" : \"danger\"}`} onClick={handleUpdatePayment}>{text ? \"已付款\" : \"未付款\"}</Button>)\n        }\n      },\n      {\n        title: \"\",\n        dataIndex: 'action',\n        key: 'action',\n        render: (text, record) => {\n          const handleCancelOrder = () => {\n            cancelOrder({\n              variables: {\n                _id: record._id\n              }\n            })\n          }\n          return (\n            <Popconfirm title=\"Sure to delete?\" onConfirm={handleCancelOrder}>\n              {/* <div style={{width: '100%', textAlign: 'center', cursor: 'pointer'}}>取消</div> */}\n          <Button type=\"danger\" size=\"small\">取消</Button>\n\n          {/* <Button type=\"danger\" size=\"small\" onClick={handleCancelOrder}>取消</Button> */}\n            </Popconfirm>\n          )\n        } \n      }\n    ]];\n    \n    let tableCol2 = [...defaultColumns, ...[\n      {\n        title: \"付款状态\",\n        dataIndex: 'paid',\n        key: 'paid',\n        render: (text, record) => {\n          const handleUpdatePayment = () => {\n            updateOrderPayment({\n              variables: {\n                _id: record._id,\n                paid: !record.paid\n              }\n            })\n          }\n          return (<Button type={`${text ? \"primary\" : \"danger\"}`} size=\"small\" onClick={handleUpdatePayment}>{text ? \"已付款\" : \"未付款\"}</Button>)\n        }\n      },\n      {\n        title: \"Tracking No.\",\n        dataIndex: 'trackingNum',\n        key: 'trackingNum',\n        width: 200,\n        render: (text, record) => {\n          let result = null;\n          if (record.sentOut && text) {\n            result = (\n              <div>{text}</div>\n            )\n          }\n          else {\n            const handleUpdateDelivery = (value) => {\n              updateOrderDelivery({\n                variables: {\n                  _id: record._id,\n                  trackingNum: value\n                }\n              })\n            }\n            result = (\n              <Search\n                placeholder=\"Enter tracking no.\"\n                enterButton={(<CheckOutlined />)}\n                size=\"small\"\n                onSearch={handleUpdateDelivery}\n              />\n            )\n          }\n          return result;\n        } \n      }\n    ]]\n\n    let tableCol3 = [...defaultColumns, ...[\n      {\n        title: \"Last Updated\",\n        dataIndex: 'updatedAt',\n        key: 'updatedAt',\n        sorter: (a, b) => new Date(a.updatedAt) - new Date(b.updatedAt),\n        render: (text, record) => {\n          let dateTime = format(new Date(text), \"MM/dd/yyyy hh:mm:ss aa\")\n          return dateTime;\n        }\n      },\n      {\n        title: \"Tracking No.\",\n        dataIndex: 'trackingNum',\n        key: 'trackingNum',\n        render: (text, record) => {\n          return text\n        } \n      }\n    ]]\n\n    return {\n      newOrders: tableCol1,\n      paidOrders: tableCol2,\n      completedOrders: tableCol3\n    }\n  }\n\n  const getFilteredOrders = () => {\n    let allOrders = data ? data.orders : [];\n    let orderList1 = [];\n    let orderList2 = [];\n    let orderList3 = [];\n    allOrders.map((anOrder)=>{\n      if (!anOrder.paid && !anOrder.sentOut) {\n        orderList1.push(anOrder);\n      }\n      else if (anOrder.paid && !anOrder.sentOut) {\n        orderList2.push(anOrder);\n      }\n      else if (anOrder.paid && anOrder.sentOut) {\n        orderList3.push(anOrder);\n      }\n    });\n    return {\n      newOrders: orderList1,\n      paidOrders: orderList2,\n      completedOrders: orderList3\n    }\n  }\n\n  let filteredColumns = getColumnsByTable();\n  let filteredOrders = getFilteredOrders();\n\n  const colWidth = 100;\n  return (\n    <Page_01\n      title={\"Orders\"}\n      //extra={[\n      //  <Button key=\"create\" type=\"primary\" icon={<PlusOutlined />} />\n      //]}\n    >\n      <Tabs defaultActiveKey=\"1\">\n        <TabPane tab=\"New Orders\" key=\"1\">\n          <Table\n            rowKey={'_id'}\n            columns={filteredColumns.newOrders} \n            dataSource={filteredOrders.newOrders} \n            pagination={false}\n            size=\"small\"\n            scroll={{x: filteredColumns.newOrders.length * colWidth}}\n            footer={null}\n            //locale={{emptyText:emptyTablePlaceholder}}\n          />\n        </TabPane>\n        <TabPane tab=\"Paid Orders\" key=\"2\">\n          <Table\n            rowKey={'_id'}\n            columns={filteredColumns.paidOrders} \n            dataSource={filteredOrders.paidOrders} \n            pagination={false}\n            size=\"small\"\n            scroll={{x: filteredColumns.paidOrders.length * colWidth}}\n            footer={null}\n            //locale={{emptyText:emptyTablePlaceholder}}\n          />\n        </TabPane>\n        <TabPane tab=\"Completed Orders\" key=\"3\">\n          <Table\n            rowKey={'_id'}\n            columns={filteredColumns.completedOrders} \n            dataSource={filteredOrders.completedOrders} \n            pagination={false}\n            size=\"small\"\n            scroll={{x: filteredColumns.completedOrders.length * colWidth}}\n            footer={null}\n            //locale={{emptyText:emptyTablePlaceholder}}\n          />\n        </TabPane>\n      </Tabs>\n      <OrderInfo\n        order={selectedOrder}\n        visible={orderModalDisplay}\n        closeModal={handleOrderModalDisplayClose}\n      />\n    </Page_01>\n  )\n}\n\nexport default Orders;","import React from 'react';\nimport { Route, Redirect, useLocation } from 'react-router-dom';\nimport { useUserCache, useConfigCache } from '../Constants';\n\nconst PrivateRoute = ({ component: Component, ...rest }) => {\n  let routeLocation = useLocation();\n  const defaultRoute = \"/login\";\n\n  const userResult = useUserCache();\n  const configResult = useConfigCache();\n  \n  let loggedIn = false;\n  if (userResult && userResult.success && configResult) {\n    loggedIn = true;\n  }\n\n  return (\n    // Show the component only when the user is logged in\n    // Otherwise, redirect the user to /signin page\n    <Route {...rest} render={props => (\n      loggedIn ?\n        <Component {...props} />\n        : <Redirect to={{\n                  pathname: defaultRoute,\n                  state: { from: routeLocation }\n              }} />\n    )} />\n  );\n};\n\nexport default PrivateRoute;\n\n/*\ntype of page route\nprivate route = only user who logged in can see\neg. products/inventory pages\n\npublic route (not restricted) = anyone can see\neg. main page/not sensitive info\n\npublic route (restricted) = only user who is not logged in can see\neg. login page\n\n*/","import React from 'react';\nimport { Route, Redirect, useLocation } from 'react-router-dom';\nimport { useUserCache, useConfigCache } from '../Constants';\n\nconst PublicRoute = ({ component: Component, restricted, ...rest }) => {\n  let routeLocation = useLocation();\n\n  const defaultRoute = \"/\";\n  const userResult = useUserCache();\n  const configResult = useConfigCache();\n  \n  let loggedIn = false;\n  if (userResult && userResult.success && configResult) {\n    loggedIn = true;\n  }\n\n  return (\n    // restricted = false meaning public route\n    // restricted = true meaning restricted route\n    <Route {...rest} render={props => (\n      loggedIn && restricted ?\n        <Redirect to={{\n            pathname: defaultRoute,\n            state: { from: routeLocation }\n        }} />\n        : <Component {...props} />\n    )} />\n  );\n};\n\nexport default PublicRoute;","import React from 'react';\n\nconst PageNotFound = () => {\n    return (\n        <div>\n            404: Page Not Found\n        </div>\n    )\n}\n\nexport default PageNotFound;","import React, {useState, useEffect} from 'react';\nimport {\n  BrowserRouter as Router,\n  Route,\n  Switch\n} from 'react-router-dom';\nimport { Button } from \"antd\";\n\nimport logo from './logo.svg';\n\nimport './css/index.css';\n\nimport * as Component from './component/index.js';\nimport Login from './component/page/Login';\nimport Products from './component/page/Products';\nimport Inventory from './component/page/Inventory';\nimport Orders from './component/page/Orders';\nimport Page_01 from './component/page/component/Page_01';\n\nimport PrivateRoute from './utils/component/PrivateRoute';\nimport PublicRoute from './utils/component/PublicRoute';\nimport PageNotFound from './utils/component/PageNotFound';\nimport Loading from './utils/component/Loading';\nimport { useConfigCache } from './utils/Constants';\n\n\nlet Component_Layout = Component['Layout_01'];\nlet Component_Header = Component['Header_01'];\n// let Component_Footer = Component['Header_01'];\n\nconst App = (props) => {\n  const [ loggedIn, setLoggedIn ] = useState(false);\n  const configCache = useConfigCache();\n\n  useEffect(()=>{\n    if (configCache) {\n      setLoggedIn(true)\n    }\n    else {\n      setLoggedIn(false)\n    }\n  },[configCache]);\n  \n  const Main = () => {\n    return (\n      <div>\n        Main\n      </div>\n    )\n  }\n\n  return (\n    <Router>\n      <Component_Layout\n        header={loggedIn ? (<Component_Header/>) : null}\n        footer={loggedIn ? \"2020\" : null}\n      >\n        <Switch>\n          {/* <PrivateRoute exact path={'/products'} component={Products}/> */}\n          <PrivateRoute exact path={'/'} component={Inventory} />\n          <PrivateRoute exact path={'/main'} component={Main} />\n          <PrivateRoute exact path={'/orders'} component={Orders} />\n          <PrivateRoute exact path={'/configuration'} component={Main} />\n          <PublicRoute restricted={true} exact path={'/login'} component={Login} />\n          <Route component={PageNotFound} />\n        </Switch>\n      </Component_Layout>\n    </Router>\n  )\n\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { ApolloProvider } from '@apollo/react-hooks';\nimport gql from \"graphql-tag\";\n\n// import './css/base.css';\nimport App from './App';\nimport ApolloClientAPI from './utils/ApolloClientAPI';\nimport { setUserCache, setConfigCache } from './utils/Constants';\nimport * as serviceWorker from './serviceWorker';\n\nconst GET_LOGGED_IN_USER = gql`\n  query loggedInUser{\n    loggedInUser{\n        success\n        message\n        data\n    }\n  }\n`\n\nconst GET_USER_CONFIG = gql`\n  query userConfig($configId: String!) {\n    userConfig(configId: $configId) {\n        success\n        message\n        data\n    }\n  }\n`\n\nconst theClientAPI = ApolloClientAPI();\nexport default theClientAPI;\nconst { client, cache, ...restClient } = theClientAPI;\nclient.writeData({\n  data: {\n    user: null,\n    config: null\n  },\n})\nconst run = () => {\n  const doRender = (userData=null,configData=null) => {\n    if (userData != null && configData != null) {\n      setUserCache(userData, client)\n      setConfigCache(configData, client)\n    }\n    // cache.writeData({\n    //   data: {\n    //     user: userData,\n    //     config: configData\n    //   },\n    // })\n    ReactDOM.render((\n        <ApolloProvider client={client}>\n            <App />\n        </ApolloProvider>\n    ),document.getElementById('root'));\n  }\n\n  restClient.query(GET_LOGGED_IN_USER).then(result=>{\n    let userResult = result.data.loggedInUser;\n    // console.log('userResult',userResult)\n    restClient.query(GET_USER_CONFIG,{\n      configId: userResult.data.configId\n    }).then(result2=>{\n      let configResult = result2.data.userConfig.data;\n      // console.log('configResult',configResult)\n      doRender(userResult, configResult)\n    }).catch((error2)=>{\n      console.log('error2',error2)\n      doRender()\n    })\n  }).catch(error=>{\n    console.log('error',error)\n    doRender()\n  })\n  \n}\n\nconst init = () => {\n  run();\n}\n\ninit();\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}